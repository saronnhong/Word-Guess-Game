<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Hangman of Thrones</title>
</head>

<body>
    <h1>Word Guess Game</h1>
    <p id="directions-text">Press any key to get started</p>
    <p id="hangman-text"></p>
    <p id="userchoice-text"></p>
    <p id="win-text"></p>
    <p id="lose-text"></p>
    <p id="tryCount-text"></p>
    <p id="guess-text"></p>

    <script type="text/javascript">
        var directionsText = document.getElementById("directions-text");
        var hangmanText = document.getElementById("hangman-text");
        var userChoiceText = document.getElementById("userchoice-text");
        var winText = document.getElementById("win-text");
        var loseText = document.getElementById("lose-text");
        var tryCountText = document.getElementById("tryCount-text");
        var guessSoFarText = document.getElementById("guess-text");

        var gotDictArray = ["hodor", "arya", "robb", "jonsnow", "sansa", "ned", "catelyn", "theon", "rickon"]
        var win = 0;
        var lose = 0;
        var maxTries = 20;
        var gameOverCheck = 0;
        var memoryArray = [];
        var restartCheck = 0;
        choosenWord = gotDictArray[Math.floor(Math.random() * gotDictArray.length)];

        function locations(substring, string) {                       //repeats indexOf to find all same characters in word
            var a = [], i = -1;
            while ((i = string.indexOf(substring, i + 1)) >= 0) a.push(i);
            return a;
        }
        //indivChar.forEach(item => console.log(item));       //shortcut to loop through an array//creates "_ _ _ _ _"
        var emptyChar = [];
        var gameOverCheck = [];
        var indivChar = choosenWord.split("");
        for (var i = 0; i < indivChar.length; i++) {
            emptyChar.push("_");
        }
        hangmanText.textContent = emptyChar.join(" ");

        document.onkeyup = function (event) {
            if (restartCheck === 1) {
                choosenWord = gotDictArray[Math.floor(Math.random() * gotDictArray.length)];
                tryCount = 9;
                emptyChar = [];
                gameOverCheck = [];
                indivChar = choosenWord.split("");
                for (var i = 0; i < indivChar.length; i++) {
                    emptyChar.push("_");
                }
                hangmanText.textContent = emptyChar.join(" ");

                restartCheck = 0;
            }
            else {
                
                if(tryCount===0){
                    restartCheck=1;
                    lose++;
                }
                var userGuess = event.key;
                console.log(choosenWord);
                var correctChar = locations(userGuess, indivChar);
                console.log(correctChar);
                if (correctChar.length === 0){
                    tryCount--;
                //console.log(tryCount);
                }
                if(tryCount===0){
                    restartCheck=1;
                    lose++;
                }
                //console.log(correctChar);
                
                


                if (2 < correctChar.length) {                                          //checks that userPressed char was found
                    emptyChar.splice(correctChar[2], 1, userGuess);
                }
                if (1 < correctChar.length) {
                    emptyChar.splice(correctChar[1], 1, userGuess);
                }
                if (0 < correctChar.length) {
                    emptyChar.splice(correctChar[0], 1, userGuess);
                }
                else {
                    console.log("no doubles");
                }

                console.log(emptyChar);
                hangmanText.textContent = emptyChar;

                var gameOverCheck = locations("_", emptyChar);
                if (0 === gameOverCheck.length) {
                    win++;
                    console.log("game solved. restart?");
                    restartCheck = 1;
                }
                winText.textContent = "Wins: " + win;
                loseText.textContent = "Lose: " + lose;
                tryCountText.textContent = "Tries: " + tryCount;
            }
        }
    </script>
</body>

</html>